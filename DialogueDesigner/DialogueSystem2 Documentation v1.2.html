<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dialogue System 2 Documentation</title>
   
    <style>

        @import url('https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap');

        body{
            margin-top: 0;
            font-family: 'Open Sans', sans-serif;
            font-size: large;
            background-color:#1b1b1b;
            color: #d6d6d6;
            line-height: 30px;
        }


        #right{
            background-color: #1e1e1e;
            margin-top: 0;
            padding: 50px 50px;
            box-shadow: 0px 0px 200px rgba(0, 0, 0, 0.25);
        }

        a{color: #b899ff;}
        a:hover{color: #d7c6ff;}

        #main-column{
            margin-top: 0px;
            padding: 0px 200px;
            /* display: flex; */
            /* flex-wrap: nowrap; */
        }

        code{
            color: #cc95ff;
        }

        /* #left{
            position: fixed;
            top: 0;
            left: 50px;
            width: 100%;
        } */

        /* #right{
            margin-left: 450px;
            margin-right: 250px;
        } */


        table{
            width: 100%;
        }

        .big-table{
            width: 100%;
        }

        tr{
            border: solid;
            background-color: #2e2e2e;
        }
    
        tr:nth-child(even) {background-color: #292929;}


        .big-tr{
            border: solid;
        }
    
        td{
            /* border: 1px solid; */
            text-align: center;
            padding: 15px 20px;
        }
    


        td.title {
            font-weight: bold;
        }

        .big-td{
            width: 25%;
            text-align: center;
            border: 1px solid;
        }

        .small-content{
            padding-left: 50px;
        }

        .big-header{
            margin-top: 50px;
            /* color: #6ed45a; */
        }

        .small-header{
            margin-top: 50px;
            color: #6ed45a;
        }

        img{
            max-width: 1250px;
        }

        .info{
            background-color: #f8dc8028;
            border-radius: 20px;
            padding: 10px 20px;
        }

        .info::before {
            color:#6ed45a;
            font-size: larger;
            content: "! ";
        }

    </style>

</head>
<body>

    <div id="main-column">

        <div id="right">

            <h1>DIALOGUE SYSTEM 2 by radmatt</h1>
            <a href="https://radmatt.itch.io">@radmatt</a> 
            radmattsoftware@gmail.com
            
            <p class="info">Something missing? You want something to be explained further? Contact me and tell me what you think should be added to the documentation!</p>

            <p>Content:</p>
            <div id="tree">
                <ol>
                    <li><a href="#installation">Installation</a></li>
                    <li><a href="#main-files-structure">Main Files Structure</a></li>
                    <ol>
                        <li><a href="#dialogue-tscn">Dialogue.tscn</a></li>
                        <li><a href="#messages">Box / BubbleMessage.tscn</a></li>
                        <li><a href="#text-tscn">Text.tscn</a></li>
                        <li><a href="#choices-tscn">Choices.tscn</a></li>
                    </ol>
                    <li><a href="#variables">Variables</a></li>
                    <li><a href="#speed-pauses">Text Speed / Pausing</a></li>
                    <li><a href="#creating-files">Creating dialogue files</a></li>
                    <ul>
                        <li><a href="#writing-files">Writing files</a></li>
                        <li><a href="#creating-files">Creating files in DialogueDesigner</a></li>
                    </ul>
                    <li>
                        <a href="#using-in-game">Using in the game</a>
                    </li>
                </ol>
            </div>



            <h1 class="big-header" id="main-files-structure">1. Installation:</h1>
               <div class="small-content">
                   <h3>How to install:</h3>
    
                    <ol>
                        <li>Move the addons folder from the .zip into your project's main folder.</li>
                        <li>Go into <b><i>Project > Projects Settings > Plugins</i></b> and enable it (change DialogueSystem2's status to Active).</li>
                        <li>Go into <b><i>Project > Input Map</i></b> and add an input called <code>dialogue_next</code>. You will use this input to skip through the dialogue.</li>
                    </ol>
    
                    <p>You're ready to go. </p>
                    <p>This will add a new file into your Autoloads. That one file (Dialogue.tscn) is your gateway to all the nodes used in the framework. </p>
               </div>

            <h1 class="big-header" id="main-files-structure">2. Main files structure:</h1>
            <div class="small-content">
                <p>This is the way these files are structured:</p>
                <table class="big-table">
                    <tr class="big-tr">
                        <td class="big-td" colspan="4"><h1>Dialogue.tscn</h1></td>
                    </tr>
                    <tr class="big-tr">
                        <td class="big-td" colspan="2"><h2>BoxMessage.tscn</h2></td>    <td class="big-td" colspan="2"><h2>BubbleMessage.tscn</h2></td>    
                    </tr>
                    <tr class="big-tr">
                        <td class="big-td"><h3>Text.tscn</h3></td>    <td class="big-td"><h3> Choices.tscn</h3></td>  <td class="big-td"><h3>Text.tscn</h3></td>    <td class="big-td"><h3> Choices.tscn</h3></td>       
                    </tr>
                </table>
            </div>

            <div id="dialogue-tscn">
                <h2 class="small-header">1.	Dialogue.tscn (script: Dialogue.gd):</h2>
                <div class="small-content">
                    <p> Handles the file loading and reading.</p>
    
                    <h3>Exported properties:</h3>
                    <ul>
                        <li>
                            <b>Language</b> - change the language of the dialogue.
                        </li>
                        <li>
                            <b>Perspective</b> - if you’re using bubble messages in a 3D scene, set it to “3D”.
                        </li>
                        <li>
                            <b>Using type</b> - Auto – changes to whatever type was declared in the dialogue file. Box – show only box messages. Bubble – show only bubble messages.
                        </li>
                        <li>
                            <b>Dialogue Next Input</b> - name of the action (set in Godot’s Input Map tab) which, when pressed, will continue the dialogue.
                        </li>
    
                    </ul>
                    
                    <h3>Signals:</h3>
                    <ul>
                        <li>
                            <b>dialogue_started</b> – emitted when the dialogue starts.
                        </li>
                        <li>
                            <b>dialogue_ended</b> – emitted when the dialogue ends.
                        </li>
                    </ul>
                    You can use these signals to extend the system with things like “when the dialogue starts, disable player’s movement” without messing with the main files.
                </div>
            </div>

            <div id="messages">
                <h2 class="small-header">2. BoxMessage.tscn and BubbleMessage.tscn (Message.gd):</h2> 
                <div class="small-content">
                    <p>There are two ways of displaying a text message: a classic box message, 
                        shown at a fixed position (at the bottom of the screen by default) 
                        and a floating message. Using a floating type of message you need to have 
                        a node to which you will attach the floating bubble to. Otherwise it will 
                        just stay at the center of the screen.</p>
    
                    <h3>Exported properties:</h3>
                    <ul>
                        <li><b>* Text Path</b> - this must be connected to your text handling node. </li>
                        <li><b>* Choices Path</b> - this must be connected to your choices handling node.</li>
                        <li><b>Text Speed</b> - the speed at which the text will appear (typewriter effect).</li>
                        <li><b>Sound Effect Speed</b> - the frequency at which the sound will be played.</li>
                        <li><b>Bubble Y Offset</b> - when using bubbles, this setting changes how high above the character it will appear (should always be negative).</li>
                        <li><b>Bubble Max Width</b> - maximum width at which the bubble will start wrapping vertically up (change it to a lower value if the bubble is too wide for your game’s viewport).</li>
                    </ul>
    
                    <h3>Signals:</h3> 
                    <ul>
                        <li><b>new_message_started</b> – emited when the new message starts.</li>
                        <li><b>message_ended</b> – emitted when the message ends (all text characters are visible).</li>
                    </ul>
            
                    <p class="warning">
                        * The reason why I exported these node paths is that you might want to put your own custom text nodes 
                        and choices nodes in different places. This way you can easily keep track of them. Important: sometimes when you change these 
                        scripts, the node paths get confused and you’ll have to click the little reset value icon in order to reset them to their actual values.
                    </p>
                </div>
            </div>

            <div id="text-tscn">
               <h2 class="small-header"> 3. Text.tscn (Text.gd):</h2>
               <div class="small-content">
                   <p>A custom-designed node for text display:</p> 
    
                    <p>
                        Godot currently does not have a universal text node that handles both the positioning and margins as well as the bbcode formatting
                        (<a href="https://github.com/godotengine/godot-proposals/issues/826" target="_blank">see this github proposal</a>). 
                        That’s why bubble messages in the first version of this system did not support bbcode. However, thanks
                        to this custom node (made by yours truly) you can now have advanced text formatting in dynamic, floating messages.
                    </p>
    
                  <p class="warning">Current limitation of the Text node: if you copy a long text instead of writing it, the dynamic margins will not work. The same goes for when you’re deleting the whole text. </p>  
               </div>

            </div>

            <div id="choices-tscn">
                <h2 class="small-header">4. Choices.tscn (Choices.gd):</h2> 
                <div class="small-content">
                    <p>Handles multiple choices.</p> 
    
                    <h3>Exported properties:</h3>
                    <ul>
                        <li>
                            <b>Choices Container</b> – your own custom choices nodes might have different node structures, 
                            that’s why here you can tell the script which node is the container to which the choice buttons will be added. 
                        </li>
                        <li>
                            <b>Choice Button</b> – again, different choices nodes might require different choice buttons, you can set its file path here.
                        </li>
                    </ul>
                </div>
                
            </div>


            <h1 class="big-header">3.Variables</h1>
            <div class="small-content" id="variables">
                <ul> 
                   <li><b>Getting a game variable</b>: <code>@variable_name@</code> </li>
                   <ul>
                       <li>Example: <i>Hi! My name is @GlobalScript.player_name@.</i> </li>
                   </ul>
                    
                   <li><b>Getting a local variable</b>: <code>@Dialogue.get_var("variable_name")@</code> </li>
                   <ul>
                       <li>Example: <i>We've talked @Dialogue.get_var("times_talked")@ times.</i> </li>
                   </ul>
                   
                <p class="warning"> <b>Differences between global and local variables: </b> Global variables are the variables you can call 
                    normally from gdscript files in Godot. Local variables are variables stored only in <code>Dialogue.gd</code> file in <code>local={}</code> dictionary. 
                    They are defined in the dialogue file and can be changed by using the <code>set_local_variable</code> dialogue node.</p>

                </ul>
            </div>

            <h1 class="big-header">4.Text Speed / Pausing</h1>
            <div class="small-content" id="speed-pauses">

                <p class="info">Only in versions 1.10+</p>
                <p>The text will pause automatically on puctuation marks (<code>. , ! ? ... ;</code>). See: <code>res://addons/radmatt.DialogueSystem2/other/Message.gd</code></p>

                <ul> 
                   <li><b>You can set text speed with tags</b>: &lt;fast&gt; / &lt;normal&gt; / &lt;slow&gt; </li>
                   <ul>
                       <li>Example: <i>&lt;fast&gt; This text will show up fast &lt;slow&gt; and this will be slow &lt;normal&gt; and this normal.</i> </li>
                   </ul>
                    
                   <li><b>Pausing at specific locations</b>: use the <code>|</code> sign (vertical line). </li>
                   <ul>
                       <li>Example: <i>The murderer is | one of you.</i> (the line is hidden - will show up as 'The murderer is one of you'). </li>
                   </ul>

                </ul>
            </div>


            <h1 class="big-header">5.Creating dialogue files</h1>
            <div class="small-content" id="creating-files">
                <p>There are two ways of creating dialogue files for this system:</p> 
                <ul>
                    <li>Text editor - writing them by hand is difficult and cumbersome but allows more flexibility and system customisation (recommended for advanced users).</li>
                    <li> <a href="https://radmatt.itch.io/dialogue-designer">DialogueDesigner</a> - easier but less customisable (recommended for beginners / intermediate users).</li>
                </ul>

                <div id="writing-files">
                    <h2 class="small-header">Writing files in a code editor:</h2>

                    Go to the <i><b>test_dialogues > templates</b></i> folder. There you will see a simple dialogue file which can be
                    edited by hand (in contrast, the numbered files, f.e. '1. BBCode' are more complex and can be edited in DialogueDesinger).
                    <br><br>
                    Each node has these three basic properties: <br>
                    <table>
                        <tr><td class="title">node_name</td><td>the unique id that identifies the node. Most of them (except for "START") will have a random number assigned as the id.</td></tr>
                        <tr><td class="title">node_type</td><td>one of a few types of nodes. This is checked during the dialogue to see what logic should be used.</td></tr>
                        <tr><td class="title">next</td><td>the node_name of the next node that should be shown / executed</td></tr>
                    </table>

                   <br>

                    <table>
                        <tr><td class="title" colspan="2">START</tr>
                        <tr><td>the first node that will be executed. From here, the dialogue starts.</td></tr>
                    </table>
                    <img src="img/start.png" alt="">

                    <br>

                    <table>
                        <tr><td class="title" colspan="2">SHOW_MESSAGE</tr>
                        <tr><td class="title">character</td><td>the name of the node that will be used for floating message positioning. It can also be used to show the name of the current speaker.</td></tr>
                        <tr><td class="title">object_path</td><td>used if speaker type is set to 1. Finds the speaker through a node path.</td></tr>
                        <tr><td class="title">is_box</td><td>if checked true, the message will be shown as a box. Otherwise, i t will be a bubble.</td></tr>
                        <tr><td class="title">speaker_type</td><td>used to determine how to find the current speaker node. 0 - by name (using 'character' data), 1 - custom path ('object_path'), 2 - the node player interacted with.</td></tr>
                        <tr><td class="title">text</td><td>this property is a dictionary containing the ID of languages as keys and their respective text as value. For example: {ENG:"Hello!", FR:"Bonjour!"}.</td></tr>
                        <tr><td class="title">choices</td><td>this is an array containing dictionaries. Each dictionary is a seperate choice.</td></tr>
                        <tr><td class="title">choices: is_condition</td><td>does this choice appear only if condition is met?.</td></tr>
                        <tr><td class="title">choices: condition</td><td>if is_condition is true, this code will determine whether or not the choice should be available.</td></tr>
                        <tr><td class="title">choices: text</td><td>works the same as message text (see above).</td></tr>
                        <tr><td class="title">choices: next*</td><td>to which node should the dialogue go if this choice is selected.</td></tr>
                    </table>
                    * If there are no choices, the show_message node will have just one next value.
                    <img src="img/message_no_choices.png" alt="">

                    <br><br>

                    <table>
                        <tr><td class="title" colspan="2">EXECUTE</tr>
                        <tr><td class="title">text</td> <td> A line of code for Godot to run. For example this <code>print("Hello world!")</code> will print a simple message.</td></tr>
                    </table>    
                    <img src="img/execute.png" alt="">

                    <br>

                    <table>
                        <tr><td class="title" colspan="2">WAIT</tr>
                        <tr><td class="title">time</td> <td> A delay in seconds before the dialogue will jump to the next node. </td></tr>
                    </table>
                    <img src="img/wait.png" alt="">

                    <br>

                    <table>
                        <tr><td class="title" colspan="2">CONDITION_BRANCH</tr>
                        <tr><td class="title">text</td> <td> The condition (in GDScript). The dialogue will take either of two paths depending on if the condition is true or false.</td></tr>
                        <tr><td class="title">branches</td><td> There are two branches: <code>True</code> and <code>False</code>. Their values are the IDs of the next node they will go to (they work the same as 'next' in other nodes).</td></tr>
                    </table> 
                    <img src="img/condition_branch.png" alt="">
                    
                    <br>

                    <table>
                        <tr><td class="title" colspan="2">RANDOM_BRANCH</tr>
                        <tr><td class="title">possibilities</td> <td> How many random possibilities there should be.</td></tr>
                        <tr><td class="title">branches</td><td> Their values are the IDs of the next node they will go to (they work the same as 'next' in other nodes).</td></tr>
                    </table> 
                    <img src="img/random_branch.png" alt="">

                    <br>

                    <table>
                        <tr><td class="title" colspan="2">CHANCE_BRANCH</tr>
                        <tr><td class="title">chance_1</td> <td> The chance in percentages of how likely it is that branch 1 will be chosen.</td></tr>
                        <tr><td class="title">chance_2</td><td> The chance in percentages of how likely it is that branch 2 will be chosen.</td></tr>
                        <tr><td class="title">branches</td><td> Their values are the IDs of the next node they will go to (they work the same as 'next' in other nodes).</td></tr>
                    </table> 
                    <img src="img/chance_branch.png" alt="">

                    <br>

                    <table>
                        <tr><td class="title" colspan="2">REPEAT</tr>
                        <tr><td class="title">value</td> <td> How many times should the system repeat a part of dialogue (from 'next' to 'next_done').</td></tr>
                        <tr><td class="title">next</td> <td> Should point to a node that has already been shown.</td></tr>
                        <tr><td class="title">next_done</td> <td> Once the dialogue has been repeated enough times (see 'value'), the dialogue will go to a node which this value points to.</td></tr>
                    </table> 
                    <img src="img/repeat.png" alt="">

                    <br>

                    <table>
                        <tr><td class="title" colspan="2">SET_LOCAL_VARIABLE</tr>
                        <tr><td class="title">var_name</td> <td> The name of the variable.</td></tr>
                        <tr><td class="title">value</td> <td> The value that the variable should be changed to.</td></tr>
                    </table> 
                    <img src="img/set_var.png" alt="">


                    <h2 class="small-header">Setting local variables:</h2>
                    <img src="img/local_vars.png" alt="" width="90%">
                    <br>

                    Structure: 
                    <br>
                
                    <pre>
name_of_the_variable : {
    "type": 0/1/2, *
    "value": <code>str / int / bool</code>
}
                </pre>
                * types: 0 = string , 1 = number , 2 = true or false
                </div>

                <h2 class="small-header">Characters:</h2>
                Here you can define the characters appearing in the dialogue. <br>
                <img src="img/chars.png" alt="">

                <h2 class="small-header">Languages:</h2>
                Here you can define languages of the messages. <br>
                <img src="img/lang.png" alt="">
                



                <div id="creating-files">
                    <h2 class="small-header">Creating files in DialogueDesigner:</h2>

                    <a href="https://steamcdn-a.akamaihd.net/steam/apps/1273620/manuals/Dialogue_Designer_Documentation.pdf?t=1587413769">Documentation</a> 
                    <br>
                    <br>

                    <a href="https://store.steampowered.com/app/1273620/Dialogue_Designer/">DialogueDesigner on Steam</a> <br>
                    <a href="https://radmatt.itch.io/dialogue-designer">DialogueDesigner on Itch.io</a> 
                    <br>
                    <br>
                </div>
            </div>

            <h1 class="big-header">6.Using in the game</h1>
            <div class="small-content" id="using-in-game">
               <p>To play a dialogue, call this function from anywhere in the game (the main file is an Autoload): <br> <code>Dialogue.start_dialogue(json_path, interacted_object=null)</code>.</p>

               <ul>
                    <li><b>json_path</b> is a path to the file containing the dialogue. *</li>
                    <ul>
                        <li>Example: <code>"res://test_dialogues/dialogue_01.json"</code></li>
                    </ul>
                   <li><b>interacted_object</b> (optional) (null by default) (is saved as <code>interacted_character</code>) should be used as a way to get the node that the player is talking to.</li>
                   <ul>
                       <li>Example: <code>Dialogue.interacted_character.show_talking_animation()</code></li>
                   </ul>
               </ul>
               
                <p class="info"> * Godot does not show JSON files in the files explorer, so you need to copy the folder path and then write the name of 
                the json file by hand.</p>

            </div>

        </div>

    </div>

</body>
</html>